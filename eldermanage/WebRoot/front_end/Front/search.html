<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">

	<title>搜索页面</title>

	<link href="AmazeUI-2.4.2/assets/css/amazeui.css" rel="stylesheet" type="text/css" />
	<link href="AmazeUI-2.4.2/assets/css/admin.css" rel="stylesheet" type="text/css" />
	<link rel="stylesheet" href="css/layui.css"  media="all">

	<link href="basic/css/demo.css" rel="stylesheet" type="text/css" />

	<link href="css/seastyle.css" rel="stylesheet" type="text/css" />

	<script type="text/javascript" src="basic/js/jquery-1.7.min.js"></script>
	<script type="text/javascript" src="js/script.js"></script>

	<script src="js/layui.all.js" charset="utf-8"></script>
	<script src="js/laypage.js" charset="utf-8"></script>
</head>

<body>

	<!--顶部导航条 -->
	<div class="am-container header">
		<ul class="message-l">
			<div class="topMessage">
				<div class="menu-hd">
					<a href="login.html" target="_top" class="h">亲，请登录</a>
					<a href="register.html" target="_top">免费注册</a>
				</div>
			</div>
		</ul>
		<ul class="message-r">
			<div class="topMessage home">
				<div class="menu-hd"><a href="shoppingindex.html" target="_top" class="h">商城首页</a></div>
			</div>
			<div class="topMessage my-shangcheng">
				<div class="menu-hd MyShangcheng"><a href="personal.html" target="_top"><i class="am-icon-user am-icon-fw"></i>个人中心</a></div>
			</div>
			<div class="topMessage mini-cart">
				<div class="menu-hd"><a id="mc-menu-hd" href="shopcart.html" target="_top"><i class="am-icon-shopping-cart  am-icon-fw"></i><span>购物车</span><strong id="J_MiniCartNum" class="h">0</strong></a></div>
			</div>
			
		</ul>
		</div>

		<!--悬浮搜索框-->

		<div class="nav white">
			<div class="logo"><img src="images/product/logo.png" /></div>
			<div class="logoBig">
				<li><img src="images/product/logobig.png" /></li>
			</div>

			<div class="search-bar pr">
				<a name="index_none_header_sysc" href="#"></a>
				<form>
					<input id="searchInput" name="index_none_header_sysc" type="text" placeholder="搜索" autocomplete="off">
					<input id="ai-topsearch" class="submit am-btn"  value="搜索" index="1" type="button">
				</form>
			</div>
		</div>

		<div class="clear"></div>
		<b class="line"></b>
       <div class="search">
		<div class="search-list">
		<div class="nav-table">
				   <div class="long-title"><span class="all-goods">全部分类</span></div>
				   <div class="nav-cont">
						<ul>
							<li class="index"><a href="shoppingindex.html">首页</a></li>
                            <li class="qc"><a href="groupindex.html">团购</a></li>
						</ul>						  
					</div>
		</div>
		
			
				<div class="am-g am-g-fixed">
					<div class="am-u-sm-12 am-u-md-12">
                  	<div class="theme-popover">														
						<div class="searchAbout">
							
						</div>
						<ul class="select">
							<p class="title font-normal">
								<span class="fl" id="searchTitle" style="color: red;"></span>
								<span class="total fl">搜索到<strong class="num" id="searchCount" style="color: red;"></strong>件相关商品</span>
							</p>
							<div class="clear"></div>
							<li class="select-result">
								<dl>
									<dt>已选</dt>
									<dd class="select-no"></dd>
									<p class="eliminateCriteria">清除</p>
								</dl>
							</li>
							<div class="clear"></div>
				        
						</ul>
						<div class="clear"></div>
                    </div>
						<div class="search-content">
							<div class="sort">
								<li class="first"><a href="">综合排序</a></li>
								<li><a href="" id="countSort">销量排序</a></li>
								<li><a href="" id="priceSort">价格优先</a></li>
								<li class="big"><a href="">评价为主</a></li>
							</div>
							<div class="clear"></div>

							<ul class="am-avg-sm-2 am-avg-md-3 am-avg-lg-4 boxes" id="searchItem">
								
							</ul>
						</div>
						
						<div class="clear"></div>
						<!--分页 -->
						<div id="demo5" style="text-align: center;"></div>

					</div>
				</div>
				<div class="footer">
					<div class="footer-hd">
						<p>
							<a href="# ">孝和集团</a>
							<b>|</b>
							<a href="# ">商城首页</a>
							<b>|</b>
							<a href="# "></a>
							<b>|</b>
							<a href="# "></a>
						</p>
					</div>
					<div class="footer-bd">
						<p>
							<a href="index.html ">关于孝和</a>
							<a href="# "></a>
							<a href="contact.html">联系我们</a>
							<a href="# "></a>
							<em>© 2017-2025 oldermanage.com 更关注老年人 - Collect from 孝和集团</em>
						</p>
					</div>
				</div>
			</div>

		</div>

	<!--引导 -->
	<div class="navCir">
		<li><a href="home.html"><i class="am-icon-home "></i>首页</a></li>
		<li><a href="sort.html"><i class="am-icon-list"></i>分类</a></li>
		<li><a href="shopcart.html"><i class="am-icon-shopping-basket"></i>购物车</a></li>	
		<li><a href="person/index.html"><i class="am-icon-user"></i>我的</a></li>					
	</div>

	<!--菜单 -->
	<div class=tip>
		<div id="sidebar">
			<div id="wrap">
				<div id="prof" class="item">
					<a href="#">
						<span class="setting"></span>
					</a>
					<div class="ibar_login_box status_login">
						<div class="avatar_box">
							<p class="avatar_imgbox"><img src="images/product/no-img_mid_.jpg" /></p>
							<ul class="user_info">
								<li>用户名：sl1903</li>
								<li>级&nbsp;别：普通会员</li>
							</ul>
						</div>
						<div class="login_btnbox">
							<a href="#" class="login_order">我的订单</a>
							<a href="#" class="login_favorite">我的收藏</a>
						</div>
						<i class="icon_arrow_white"></i>
					</div>

				</div>
				<div id="shopCart" class="item">
					<a href="#">
						<span class="message"></span>
					</a>
					<p>
						购物车
					</p>
					<p class="cart_num">0</p>
				</div>
				<div id="asset" class="item">
					<a href="#">
						<span class="view"></span>
					</a>
					<div class="mp_tooltip">
						我的资产
						<i class="icon_arrow_right_black"></i>
					</div>
				</div>

				<div id="foot" class="item">
					<a href="#">
						<span class="zuji"></span>
					</a>
					<div class="mp_tooltip">
						我的足迹
						<i class="icon_arrow_right_black"></i>
					</div>
				</div>

				<div id="brand" class="item">
					<a href="#">
						<span class="wdsc"><img src="images/product/wdsc.png" /></span>
					</a>
					<div class="mp_tooltip">
						我的收藏
						<i class="icon_arrow_right_black"></i>
					</div>
				</div>

				<div id="broadcast" class="item">
					<a href="#">
						<span class="chongzhi"><img src="images/product/chongzhi.png" /></span>
					</a>
					<div class="mp_tooltip">
						我要充值
						<i class="icon_arrow_right_black"></i>
					</div>
				</div>

				<div class="quick_toggle">
					<li class="qtitem">
						<a href="#"><span class="kfzx"></span></a>
						<div class="mp_tooltip">客服中心<i class="icon_arrow_right_black"></i></div>
					</li>
					<!--二维码 -->
					<li class="qtitem">
						<a href="#none"><span class="mpbtn_qrcode"></span></a>
						<div class="mp_qrcode" style="display:none;"><img src="images/product/weixin_code_145.png" /><i class="icon_arrow_white"></i></div>
					</li>
					<li class="qtitem">
						<a href="#top" class="return_top"><span class="top"></span></a>
					</li>
				</div>

				<!--回到顶部 -->
				<div id="quick_links_pop" class="quick_links_pop hide"></div>

			</div>

		</div>
		<div id="prof-content" class="nav-content">
			<div class="nav-con-close">
				<i class="am-icon-angle-right am-icon-fw"></i>
			</div>
			<div>
				我
			</div>
		</div>
		<div id="shopCart-content" class="nav-content">
			<div class="nav-con-close">
				<i class="am-icon-angle-right am-icon-fw"></i>
			</div>
			<div>
				购物车
			</div>
		</div>
		<div id="asset-content" class="nav-content">
			<div class="nav-con-close">
				<i class="am-icon-angle-right am-icon-fw"></i>
			</div>
			<div>
				资产
			</div>

			<div class="ia-head-list">
				<a href="#" target="_blank" class="pl">
					<div class="num">0</div>
					<div class="text">优惠券</div>
				</a>
				<a href="#" target="_blank" class="pl">
					<div class="num">0</div>
					<div class="text">红包</div>
				</a>
				<a href="#" target="_blank" class="pl money">
					<div class="num">￥0</div>
					<div class="text">余额</div>
				</a>
			</div>

		</div>
		<div id="foot-content" class="nav-content">
			<div class="nav-con-close">
				<i class="am-icon-angle-right am-icon-fw"></i>
			</div>
			<div>
				足迹
			</div>
		</div>
		<div id="brand-content" class="nav-content">
			<div class="nav-con-close">
				<i class="am-icon-angle-right am-icon-fw"></i>
			</div>
			<div>
				收藏
			</div>
		</div>
		<div id="broadcast-content" class="nav-content">
			<div class="nav-con-close">
				<i class="am-icon-angle-right am-icon-fw"></i>
			</div>
			<div>
				充值
			</div>
		</div>
	</div>

	<script>
		window.jQuery || document.write('<script src="basic/js/jquery-1.9.min.js"><\/script>');
	</script>
	<script type="text/javascript" src="basic/js/quick_links.js"></script>
	<div class="theme-popover-mask"></div>


	<script type="text/javascript">
		$("#searchInput").val(window.location.href.split("?")[1]);

		var serachUrl = "http://localhost:8080/eldermanage/v1/older/shop/index/search";

		var searchContent = window.location.href.split("?")[1];

		var searchType = null;

		$("#ai-topsearch").click(function (event){
			searchContent = $("#searchInput").val();
			window.location.href = 'search.html?'+ searchContent;
		});

		$("#countSort").click(function (event){
			// 刷新页面调用
			//window.location.href = 'search.html?'+ searchContent;

			//ajax调用， 不刷新页面
			serachUrl = "http://localhost:8080/eldermanage/v1/older/shop/index/search/sort";
			$('#searchItem').html('');
			searchContent = $("#searchInput").val()
			searchType = "销量排序"
			searchSort(serachUrl, searchContent,searchType);
			return false;
		});

		$("#priceSort").click(function (event){
			// 刷新页面调用
			//window.location.href = 'search.html?'+ searchContent;

			//ajax调用， 不刷新页面
			serachUrl = "http://localhost:8080/eldermanage/v1/older/shop/index/search/sort";
			$('#searchItem').html('');
			searchContent = $("#searchInput").val()
			searchType = "价格优先"
			searchSort(serachUrl, searchContent,searchType);
			return false;
		});

		searchAjaxContent(serachUrl, searchContent);

		function searchAjaxContent(url, content){
			$.ajax({
				type: 'get',
				contentType:'application/json',
				url: url,
				data: "info=" + content,
				success:function(result){
					var searchData = result.data;

					$('#searchCount').text(' ' + searchData.length + ' ');
					$("#searchTitle").html('"' + window.location.href.split("?")[1] +'"');

					// for(var i=searchData.length - 1;i>=0;i--){
					// 	var oLi = `
					// 		<li>
					// 			<div class="i-pic limit">
					// 				<img src="images/product/imgsearch1.jpg" />											
					// 				<p class="title fl">${searchData[i].productname}</p>
					// 				<p class="price fl">
					// 					<b>¥</b>
					// 					<strong>${searchData[i].productprice}</strong>
					// 				</p>
					// 				<p class="number fl">
					// 					销量<span>${searchData[i].storetotalsales}</span>
					// 				</p>
					// 			</div>
					// 		</li>
					// 	`;
					// 	$('#searchItem').append($(oLi));
					// }

					$("#demo5").show();
					page(searchData, $("#demo5"));
				},
				error:function(){
					alert('数据库错误')
				}
			})
		}

		function searchSort(url, content,sortType){

			$.ajax({
				type: 'get',
				contentType:'application/json',
				url: url,
				data: "info=" + content + "&sort=" + sortType,
				success:function(result){
					var searchData = result.data;

					$('#searchCount').text(' ' + searchData.length + ' ');
					$("#searchTitle").html('"' + window.location.href.split("?")[1] +'"');

					// for(var i=0;i<=searchData.length - 1;i++){
					// 	var oLi = `
					// 		<li>
					// 			<div class="i-pic limit">
					// 				<img src="images/product/imgsearch1.jpg" />											
					// 				<p class="title fl">${searchData[i].productname}</p>
					// 				<p class="price fl">
					// 					<b>¥</b>
					// 					<strong>${searchData[i].productprice}</strong>
					// 				</p>
					// 				<p class="number fl">
					// 					销量<span>${searchData[i].storetotalsales}</span>
					// 				</p>
					// 			</div>
					// 		</li>
					// 	`;
					// 	console.log('${searchData[i].productname');
					// 	$('#searchItem').append($(oLi));
					// }

					$("#demo5").show();
					page(searchData, $("#demo5"));
				},
				error:function(){
					alert('数据库错误')
				}
			})
		}

		//分页
		function page(videodata, pageRoot){
			layui.use(['laypage', 'layer'], function(){
				var laypage = layui.laypage
				,layer = layui.layer;
				laypage.render({
				    elem: pageRoot
				    ,count: videodata.length
				    ,limit: 12  //每页个数
				    ,curr: location.hash.replace('#!fenye=', '') //获取hash值为fenye的当前页
				    ,hash: 'fenye' //自定义hash值
				    ,jump: function(obj){
				      //模拟渲染
				      document.getElementById('searchItem').innerHTML = function(){
				        var arr = []
				        ,thisData = videodata.concat().splice(obj.curr*obj.limit - obj.limit, obj.limit);
				        layui.each(thisData, function(index, item){
				        	let datas =`
								<li>
									<div class="i-pic limit">
										<img src="${item.productimg}" />											
										<p class="title fl">${item.productname}</p>
										<p class="price fl">
											<b>¥</b>
											<strong>${item.productprice}</strong>
										</p>
										<p class="number fl">
											销量<span>${item.storetotalsales}</span>
										</p>
									</div>
								</li>
							`;
				        	arr.push(datas);
				        });
				        return arr.join('');
				      }();
				    }
				});
			});
		}
	</script>


</body>
</html>