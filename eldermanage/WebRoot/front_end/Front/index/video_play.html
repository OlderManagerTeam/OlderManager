<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>孝和视频播放页</title> 
	
	<!-- mobile responsive meta -->
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
	<link rel="stylesheet" href="css/style.css">
	<link rel="stylesheet" href="css/responsive.css">
	<link rel="stylesheet" href="fonts/flaticon.css" />
	<link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:400,500,700">
	<link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Open+Sans:400,600,700">
	<link rel="stylesheet" type="text/css" href="css/bootstrap.min.css">
	<link rel="stylesheet" type="text/css" href="css/bootstrap-select.min.css">
	<link rel="stylesheet" type="text/css" href="css/jquery.bootstrap-touchspin.css">
	<link rel="stylesheet" type="text/css" href="css/font-awesome.css">
	<link rel="stylesheet" type="text/css" href="css/flaticon.css">
	<link rel="stylesheet" type="text/css" href="assets/revolution/css/settings.css">
	<link rel="stylesheet" type="text/css" href="assets/revolution/css/layers.css">
	<link rel="stylesheet" type="text/css" href="assets/revolution/css/navigation.css">
	<link rel="stylesheet" type="text/css" href="css/owl.carousel.css">
	<link rel="stylesheet" type="text/css" href="css/jquery.bxslider.css">
	<link rel="stylesheet" type="text/css" href="css/flexslider.css">
	<link rel="stylesheet" type="text/css" href="css/jquery-ui.css">
	<link rel="stylesheet" type="text/css" href="css/jquery.fancybox.css">
	<link rel="stylesheet" type="text/css" href="css/polyglot-language-switcher.css">
	<link rel="stylesheet" type="text/css" href="css/animate.min.css">
	<link rel="stylesheet" type="text/css" href="css/nouislider.css">
	<link rel="stylesheet" type="text/css" href="css/nouislider.pips.css">
	<link rel="stylesheet" type="text/css" href="css/menuzord.css">
	<link rel="stylesheet" type="text/css" href="css/magnific-popup.css">
	<link rel="stylesheet" type="text/css" href="css/hover.css">
	
	<link rel="stylesheet" type="text/css" href="css/reset.css">

	<style type="text/css">
		
	</style>

</head>

<body>
	<div class="boxed_wrapper">
		<div class="header-top">
			<div class="container clearfix">
				<!--Top Left-->
				<div class="top-left pull-left">
					<ul class="links-nav clearfix">
						<li><a href=""><span class="fa fa-phone"></span> 全国热线:  123 4561 5523 </a></li>
						<li><a href=""><span class="fa fa-envelope"></span>电子邮箱:  info@templatepath.com</a></li>
					</ul>
				</div>
				<!--Top Right-->
                    <div class="top-right pull-right">
					<div class="social-links clearfix">
						<a href="personal_center.html" id="person_center">
							<span>个人中心</span>
							<span class="badge" style="margin-left: 3px;" id="myNewsCount"></span>
						</a>
						<a href="../login/login.html" id="myCenter">
							<span id="myName">请登录</span>
						</a>
						<a href="" data-toggle="modal" data-target="#signUpModal" id="signUp">
							<span>注册账号</span>
						</a>
						<a href="" id="loginOut" onclick="login_out();return false;" data-toggle="modal">
							<span>注销</span>
						</a>
					</div>
				</div>
			</div>
		</div><!-- Header Top End -->

		<!-- Menu -->
		<section class="theme_menu stricky">
			<div class="container">
				<div class="row" style="background-color: #fff;">
					<div class="col-md-3">
						<div class="main-logo">
							<a href="index.html"><img src="images/logo/logo.png" alt=""></a>
						</div>
					</div>
					<div class="col-md-9 menu-column">
						<nav class="menuzord" id="main_menu">
						   <ul class="menuzord-menu">
								<li><a href="index.html" style="font-size: 25px;">首页</a></li>
								<li><a href="videos.html" style="font-size: 25px;">课程视频</a></li>
								<li><a href="lecture.html" style="font-size: 25px;">讲座活动</a></li>
								<li><a href="news-center.html" style="font-size: 25px;">新闻中心</a></li>
								<li><a href="../shoppingindex.html" style="font-size: 25px;">商城首页</a></li>
								<li><a href="about.html" style="font-size: 25px;">关于我们</a></li>
							</ul> <!-- End of .menuzord-menu -->
						</nav> <!-- End of #main_menu -->
					</div>
					<!-- <div class="col-md-2">
						<div class="right-area">
						   <div class="link_btn float_right">
							   <a href="#" class="thm-btn">GET A Quote?</a>
						   </div>
						</div>	
					</div> -->
				</div>
			</div> <!-- End of .conatiner -->
		</section> <!-- End of .theme_menu -->

		<section>
        	<div class="container">
            	<div class="col-md-12" style="padding-top: 50px;padding-bottom: 50px;background-color: #f5f5f5;margin-top: 100px;margin-bottom: 100px;">
            		<video class="col-md-12 col-sm-12 col-xs-12" controls>
					  <source src="" type="video/mp4" id="videomp4">
					  <source src="" type="video/ogg" id="videoogg">
					  <source src="" type="video/webm" id="videowebm">
					  <object data="" width="320" height="240" id="videomp4o">
					    <embed src="" width="320" height="240" id="videoswf">
					  </object> 
					</video>
					<div class="col-md-12" style="margin-top:50px;">
						<div class="col-md-12">
							<span style="font-size:20px;">视频简介</span>
							<a href="" style="float:right;" onclick="collectVideo();return false;" id="nullStar">
								<img src="images/logo/collectionStar_none.png" style="width:25px;"/>
							</a>
							<a href="" style="float:right;" onclick="cancelCollect();return false;" id="fullStar">
								<img src="images/logo/collectionStar.png" style="width:25px;"/>
							</a>
						</div>
						<div class="col-md-12">
							<p style="font-size:15px;" id="videoInfo"></p>
							<input type="hidden" id="starState">
						</div>
					</div>
            	</div>
            </div>
        </section>

		<!-- 注册提示模态框-->
		<div class="modal fade" id="signUpModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" style="margin-top: 100px;">
		    <div class="modal-dialog">
		        <div class="modal-content">
		            <div class="modal-header">
		                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
		                <h4 class="modal-title" id="myModalLabel">注册提示</h4>
		            </div>
		            <div class="modal-body">亲，我们暂不支持在线注册，如需注册请联系工作人员:13310105261</div>
		            <div class="modal-footer">
		                <button type="button" class="btn btn-primary" data-dismiss="modal">关闭</button>
		            </div>
		        </div><!-- /.modal-content -->
		    </div><!-- /.modal -->
		</div>

		<!-- 注销提示模态框-->
		<div class="modal fade" id="loginOutModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" style="margin-top: 100px;">
		    <div class="modal-dialog">
		        <div class="modal-content">
		            <div class="modal-header">
		                <!-- <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button> -->
		                <h4 class="modal-title" id="myModalLabel">注销提示</h4>
		            </div>
		            <div class="modal-body" id="login_info"></div>
		            <div class="modal-footer">
		                <button type="button" class="btn btn-primary" data-dismiss="modal" onclick="reload()">确定</button>
		            </div>
		        </div><!-- /.modal-content -->
		    </div><!-- /.modal -->
		</div>		

		<footer class="footer bg-style" style="background-image:url(images/background/bg-3.jpg);">
			<div class="container">
				<div class="footer-upper" style="padding: 50px 0 20px;">
				
					<div class="row">
						<div class="col-md-2 col-sm-6">
							<div class="footer-widget quick-links">
								<h3 class="title">孝和集团</h3>
								<ul>
									<li><a href="index.html">官网首页</a></li>
									<li><a href="video.html">课程视频</a></li>
									<li><a href="lecture.html">讲座活动</a></li>
									<li><a href="news-center.html">新闻中心</a></li>
									<li><a href="../shoppingindex.html">官方商城</a></li>
									<li><a href="about.html">关于我们</a></li>
									<li><a href="../login/login_staff.html">后台管理</a></li>
								</ul>
							</div>
						</div>
						<div class="col-md-3 col-sm-6">
							<div class="footer-widget opening-hour">
								<h3 class="title">营业时间</h3>
								
								<ul class="day-time">
									<li><span>Mon-Set &nbsp;:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span>08.00 - 17.00 </span></li>
									<li><span>Sunday &nbsp;&nbsp;&nbsp;:</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>09.00 - 15.00</span></li>
									<li><span>Friday&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span>Closed</span></li>
								</ul>
							</div>
						</div>
						<div class="col-md-2 col-sm-6 col-xs-6">
							<div class="footer-widget opening-hour">
								<h3 class="title">官方微信</h3>
								
								<img src="images/logo/code.png">
							</div>
						</div>
					</div>
				</div>
				<!--Footer Bottom-->
				<div class="footer-bottom">					
					<div class="pull-left"><div class="copyright-text">Copyright &copy; 2017.Company name All rights reserved.<a target="_blank" href="http://www.17sucai.com/"></a></div></div>
				</div>
			</div>
		</footer>
		
		<!-- 登录提示模态框-->
		<div class="modal fade" id="loginModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" style="margin-top: 100px;">
		    <div class="modal-dialog">
		        <div class="modal-content">
		            <div class="modal-header">
		                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
		                <h4 class="modal-title" id="myModalLabel">登录提示</h4>
		            </div>
		            <div class="modal-body">亲，你还没有登录哦，请先登录</div>
		            <div class="modal-footer">
		                <button type="button" class="btn btn-primary" data-dismiss="modal">关闭</button>
		                <button type="button" class="btn btn-primary">点我去登录</button>
		            </div>
		        </div><!-- /.modal-content -->
		    </div><!-- /.modal -->
		</div>
		
		<!-- 收藏成功提示模态框-->
		<div class="modal fade" id="collectSuccessModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" style="margin-top: 100px;">
		    <div class="modal-dialog">
		        <div class="modal-content">
		            <div class="modal-header">
		                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
		                <h4 class="modal-title" id="myModalLabel">收藏提示</h4>
		            </div>
		            <div class="modal-body" id="collectSuccessInfo"></div>
		            <div class="modal-footer">
		                <button type="button" class="btn btn-primary" data-dismiss="modal">确定</button>
		            </div>
		        </div><!-- /.modal-content -->
		    </div><!-- /.modal -->
		</div>

		<!-- 取消收藏成功提示模态框-->
		<div class="modal fade" id="cancelCollectSuccessModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" style="margin-top: 100px;">
		    <div class="modal-dialog">
		        <div class="modal-content">
		            <div class="modal-header">
		                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
		                <h4 class="modal-title" id="myModalLabel">取消收藏提示</h4>
		            </div>
		            <div class="modal-body" id="cancelCollectSuccessInfo"></div>
		            <div class="modal-footer">
		                <button type="button" class="btn btn-primary" data-dismiss="modal">确定</button>
		            </div>
		        </div><!-- /.modal-content -->
		    </div><!-- /.modal -->
		</div>

		<!-- 收藏失败提示模态框-->
		<div class="modal fade" id="collectFailModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" style="margin-top: 100px;">
		    <div class="modal-dialog">
		        <div class="modal-content">
		            <div class="modal-header">
		                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
		                <h4 class="modal-title" id="myModalLabel">收藏提示</h4>
		            </div>
		            <div class="modal-body" id="collectFailInfo">收藏失败,请稍后再试。</div>
		            <div class="modal-footer">
		                <button type="button" class="btn btn-primary" data-dismiss="modal">确定</button>
		            </div>
		        </div><!-- /.modal-content -->
		    </div><!-- /.modal -->
		</div>

		<!-- 取消收藏失败提示模态框-->
		<div class="modal fade" id="cancelCollectFailModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" style="margin-top: 100px;">
		    <div class="modal-dialog">
		        <div class="modal-content">
		            <div class="modal-header">
		                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
		                <h4 class="modal-title" id="myModalLabel">取消收藏提示</h4>
		            </div>
		            <div class="modal-body" id="cancelCollectFailInfo">取消收藏失败,请稍后再试。</div>
		            <div class="modal-footer">
		                <button type="button" class="btn btn-primary" data-dismiss="modal">确定</button>
		            </div>
		        </div><!-- /.modal-content -->
		    </div><!-- /.modal -->
		</div>

	<!-- Scroll Top Button -->
	<button class="scroll-top tran3s color2_bg">
		<span class="fa fa-angle-up"></span>
	</button>
	<!-- pre loader  -->
	<div class="preloader"></div>

		<!-- jQuery js -->
		<script src="js/jquery.js"></script>
		<!-- bootstrap js -->
		<script src="js/bootstrap.min.js"></script>
		<!-- jQuery ui js -->
		<script src="js/jquery-ui.js"></script>
		<!-- owl carousel js -->
		<script src="js/owl.carousel.min.js"></script>
		<!-- jQuery validation -->
		<script src="js/jquery.validate.min.js"></script>
		<!-- google map -->
		<script src="http://ditu.google.cn/maps/api/js?key=AIzaSyCRvBPo3-t31YFk588DpMYS6EqKf-oGBSI"></script> 
		<script src="js/gmap.js"></script>
		<!-- mixit up -->
		<script src="js/wow.js"></script>
		<script src="js/jquery.mixitup.min.js"></script>
		<script src="js/jquery.fitvids.js"></script>
		<script src="js/bootstrap-select.min.js"></script>
		<script src="js/menuzord.js"></script>

		<!-- revolution slider js -->
		<script src="assets/revolution/js/jquery.themepunch.tools.min.js"></script>
		<script src="assets/revolution/js/jquery.themepunch.revolution.min.js"></script>
		<script src="assets/revolution/js/extensions/revolution.extension.actions.min.js"></script>
		<script src="assets/revolution/js/extensions/revolution.extension.carousel.min.js"></script>
		<script src="assets/revolution/js/extensions/revolution.extension.kenburn.min.js"></script>
		<script src="assets/revolution/js/extensions/revolution.extension.layeranimation.min.js"></script>
		<script src="assets/revolution/js/extensions/revolution.extension.migration.min.js"></script>
		<script src="assets/revolution/js/extensions/revolution.extension.navigation.min.js"></script>
		<script src="assets/revolution/js/extensions/revolution.extension.parallax.min.js"></script>
		<script src="assets/revolution/js/extensions/revolution.extension.slideanims.min.js"></script>
		<script src="assets/revolution/js/extensions/revolution.extension.video.min.js"></script>

		<!-- fancy box -->
		<script src="js/jquery.fancybox.pack.js"></script>
		<script src="js/jquery.polyglot.language.switcher.js"></script>
		<script src="js/nouislider.js"></script>
		<script src="js/jquery.bootstrap-touchspin.js"></script>
		<script src="js/SmoothScroll.js"></script>
		<script src="js/jquery.appear.js"></script>
		<script src="js/jquery.countTo.js"></script>
		<script src="js/jquery.flexslider.js"></script>
		<script src="js/imagezoom.js"></script>	
		<script src="js/validation.js"></script>
		<script id="map-script" src="js/default-map.js"></script>
		<script src="js/custom.js"></script>

	</div>
	
	<script type="text/javascript">
		var info = decodeURI(window.location.href.split("?")[1]);
		//判断登录
		$.ajax({
			type : 'get',
			contentType : 'application/json',
			url : "/eldermanage/v1/shop/judgeLogin",
			data : null,
			success : function(result){
				if (result.success) {
					$("#myCenter").attr('href','personal_center.html')
					$('#myName').html(result.data.oldername)
					$("#signUp").hide();
					myNewsCounts();
				}else {
					$("#loginOut").hide();
					$("#person_center").hide();
				}
			},
			error:function(){
				alert('数据库错误')
			}
		})

		//注销
		function login_out(){
			$.ajax({
				type : 'delete',
				contentType : false,
				url : "/eldermanage/v1/index/person/accountnumber",
				data : null,
				success : function(result) {
					$("#login_info").html(result.information);
					$("#loginOutModal").modal('show');
				},
				error : function() {
					alert('fail')
				}
			})
		}

		//刷新页面
		function reload(){
			window.location.reload();
		}

		//视频详情
		$.ajax({
			type : 'get',
			contentType : 'application/json',
			url : "/eldermanage/v1/course/detail?videoid="+info,
			data : null,
			success:function(result){
				var resultData = result.data;

				$("#videomp4").attr("src",resultData[0].video.videourl)
				$("#videoogg").attr("src",resultData[0].video.videourl)
				$("#videowebm").attr("src",resultData[0].video.videourl)
				$("#videomp4o").attr("data",resultData[0].video.videourl)
				$("#videoswf").attr("src",resultData[0].video.videourl)
				
				$("#videoInfo").html(resultData[0].video.videointro)
				$("#starState").val(resultData[0].collectionStatue)
				if(resultData[0].collectionStatue =="未收藏"){
					$("#fullStar").hide();
				}else if(resultData[0].collectionStatue =="已收藏"){
					$("#nullStar").hide();
				}
			},
			error:function(){
				alert("数据库错误")
			}
		})

		// 未读消息数量
		function myNewsCounts(){
			$.ajax({
				type: 'get',
	        	contentType: 'application/json',
	        	url:"/eldermanage/v1/olderpersonal/newmessagecount",
	        	data:null,
	        	success:function(result){
	        		var myNewsData = result.data;
	
	        		if(myNewsData.length != 0){
						$("#myNewsCount").html(myNewsData.length)
						$("#myNewsCountMobile").html(myNewsData.length)
	        		}
	        	},
	        	error:function(){
	        		alert('数据库错误')
	        	}
			})
		}
		
		//收藏按钮
		function collectVideo(){
			if ($("#starState").val() == "未登录") {
				$("#loginModal").modal('show');
			}else if($("#starState").val() == "未收藏") {
				//报名
				$.ajax({
					type:'post',
					contentType:'application/json',
					url:"/eldermanage/v1/course/video/collectionvideo?videoid="+info,
					data:null,
					success:function(result){
						if(result.information == '收藏成功'){
							$("#collectSuccessInfo").html(result.information);
							$("#collectSuccessModal").modal('show');
							$("#nullStar").hide()
							$("#fullStar").show()
							$("#starState").val("已收藏")
						}else if(result.information == '收藏失败'){
							$("#collectFailModal").modal('show');
						}
					},
					error(){
						alert('数据库错误')
					}
				})
			}
		}

		//取消收藏按钮
		function cancelCollect(){
			if ($("#starState").val() == "未登录") {
				$("#loginModal").modal('show');
			}else if($("#starState").val() == "已收藏") {
				//报名
				$.ajax({
					type:'post',
					contentType:'application/json',
					url:"/eldermanage/v1/course/video/cancelcollection?videoid="+info,
					data:null,
					success:function(result){
						if(result.information == '取消成功'){
							$("#cancelCollectSuccessInfo").html(result.information);
							$("#cancelCollectSuccessModal").modal('show');
							$("#nullStar").show()
							$("#fullStar").hide()
							$("#starState").val("未收藏")
						}else if(result.information == '取消失败'){
							$("#cancelCollectFailModal").modal('show');
						}
					},
					error(){
						alert('数据库错误')
					}
				})
			}
		}
	</script>
</body>
</html>




